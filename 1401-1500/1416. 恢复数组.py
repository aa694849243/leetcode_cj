# -*- coding: utf-8 -*-
# æŸä¸ªç¨‹åºæœ¬æ¥åº”è¯¥è¾“å‡ºä¸€ä¸ªæ•´æ•°æ•°ç»„ã€‚ä½†æ˜¯è¿™ä¸ªç¨‹åºå¿˜è®°è¾“å‡ºç©ºæ ¼äº†ä»¥è‡´è¾“å‡ºäº†ä¸€ä¸ªæ•°å­—å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬æ‰€çŸ¥é“çš„ä¿¡æ¯åªæœ‰ï¼šæ•°ç»„ä¸­æ‰€æœ‰æ•´æ•°éƒ½åœ¨ [1, k] ä¹‹é—´ï¼Œä¸”æ•°ç»„ä¸­
# çš„æ•°å­—éƒ½æ²¡æœ‰å‰å¯¼ 0 ã€‚
#
#  ç»™ä½ å­—ç¬¦ä¸² s å’Œæ•´æ•° k ã€‚å¯èƒ½ä¼šæœ‰å¤šç§ä¸åŒçš„æ•°ç»„æ¢å¤ç»“æœã€‚
#
#  æŒ‰ç…§ä¸Šè¿°ç¨‹åºï¼Œè¯·ä½ è¿”å›æ‰€æœ‰å¯èƒ½è¾“å‡ºå­—ç¬¦ä¸² s çš„æ•°ç»„æ–¹æ¡ˆæ•°ã€‚
#
#  ç”±äºæ•°ç»„æ–¹æ¡ˆæ•°å¯èƒ½ä¼šå¾ˆå¤§ï¼Œè¯·ä½ è¿”å›å®ƒå¯¹ 10^9 + 7 å–ä½™ åçš„ç»“æœã€‚
#
#
#
#  ç¤ºä¾‹ 1ï¼š
#
#  è¾“å…¥ï¼šs = "1000", k = 10000
# è¾“å‡ºï¼š1
# è§£é‡Šï¼šå”¯ä¸€ä¸€ç§å¯èƒ½çš„æ•°ç»„æ–¹æ¡ˆæ˜¯ [1000]
#
#
#  ç¤ºä¾‹ 2ï¼š
#
#  è¾“å…¥ï¼šs = "1000", k = 10
# è¾“å‡ºï¼š0
# è§£é‡Šï¼šä¸å­˜åœ¨ä»»ä½•æ•°ç»„æ–¹æ¡ˆæ»¡è¶³æ‰€æœ‰æ•´æ•°éƒ½ >= 1 ä¸” <= 10 åŒæ—¶è¾“å‡ºç»“æœä¸º s ã€‚
#
#
#  ç¤ºä¾‹ 3ï¼š
#
#  è¾“å…¥ï¼šs = "1317", k = 2000
# è¾“å‡ºï¼š8
# è§£é‡Šï¼šå¯è¡Œçš„æ•°ç»„æ–¹æ¡ˆä¸º [1317]ï¼Œ[131,7]ï¼Œ[13,17]ï¼Œ[1,317]ï¼Œ[13,1,7]ï¼Œ[1,31,7]ï¼Œ[1,3,17]ï¼Œ[1,3,1,7
# ]
#
#
#  ç¤ºä¾‹ 4ï¼š
#
#  è¾“å…¥ï¼šs = "2020", k = 30
# è¾“å‡ºï¼š1
# è§£é‡Šï¼šå”¯ä¸€å¯èƒ½çš„æ•°ç»„æ–¹æ¡ˆæ˜¯ [20,20] ã€‚ [2020] ä¸æ˜¯å¯è¡Œçš„æ•°ç»„æ–¹æ¡ˆï¼ŒåŸå› æ˜¯ 2020 > 30 ã€‚ [2,020] ä¹Ÿä¸æ˜¯å¯è¡Œçš„æ•°ç»„æ–¹æ¡ˆï¼Œå› ä¸º
#  020 å«æœ‰å‰å¯¼ 0 ã€‚
#
#
#  ç¤ºä¾‹ 5ï¼š
#
#  è¾“å…¥ï¼šs = "1234567890", k = 90
# è¾“å‡ºï¼š34
#
#
#
#
#  æç¤ºï¼š
#
#
#  1 <= s.length <= 10^5.
#  s åªåŒ…å«æ•°å­—ä¸”ä¸åŒ…å«å‰å¯¼ 0 ã€‚
#  1 <= k <= 10^9.
#
#  Related Topics å­—ç¬¦ä¸² åŠ¨æ€è§„åˆ’
#  ğŸ‘ 37 ğŸ‘ 0
import functools


class Solution:
    def numberOfArrays(self, s: str, k: int) -> int:
        mod = 10 ** 9 + 7
        n = len(str(k))
        m = {}

        def _int(i, j):
            if (i, j) in m:
                return m[i,j]
            m[i,j]=int(s[i:j+1])
            return m[i,j]

        @functools.lru_cache(None)
        def dp(i):
            if i == -1:
                return 1
            ans = 0
            for j in range(i, max(i - n, -1), -1):
                if s[j] != '0' and _int(j,i) <= k:
                    ans+=dp(j-1)
            ans%=mod
            return ans
        return dp(len(s)-1)
Solution().numberOfArrays(s = "1290", k = 90)

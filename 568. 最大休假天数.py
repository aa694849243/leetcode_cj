#!/usr/bin/env python
# -*- coding: utf-8 -*-
import collections
from typing import List


# åŠ›æ‰£æƒ³è®©ä¸€ä¸ªæœ€ä¼˜ç§€çš„å‘˜å·¥åœ¨ N ä¸ªåŸŽå¸‚é—´æ—…è¡Œæ¥æ”¶é›†ç®—æ³•é—®é¢˜ã€‚ ä½†åªå·¥ä½œä¸çŽ©è€ï¼Œèªæ˜Žçš„å­©å­ä¹Ÿä¼šå˜å‚»ï¼Œæ‰€ä»¥æ‚¨å¯ä»¥åœ¨æŸäº›ç‰¹å®šçš„åŸŽå¸‚å’Œæ˜ŸæœŸä¼‘å‡ã€‚æ‚¨çš„å·¥ä½œå°±æ˜¯å®‰æŽ’æ—…è¡Œ
# ä½¿å¾—æœ€å¤§åŒ–ä½ å¯ä»¥ä¼‘å‡çš„å¤©æ•°ï¼Œä½†æ˜¯æ‚¨éœ€è¦éµå®ˆä¸€äº›è§„åˆ™å’Œé™åˆ¶ã€‚
#
#  è§„åˆ™å’Œé™åˆ¶ï¼š
#
#
#  æ‚¨åªèƒ½åœ¨ N ä¸ªåŸŽå¸‚ä¹‹é—´æ—…è¡Œï¼Œç”¨ 0 åˆ° N-1 çš„ç´¢å¼•è¡¨ç¤ºã€‚ä¸€å¼€å§‹ï¼Œæ‚¨åœ¨ç´¢å¼•ä¸º0çš„åŸŽå¸‚ï¼Œå¹¶ä¸”é‚£å¤©æ˜¯æ˜ŸæœŸä¸€ã€‚
#  è¿™äº›åŸŽå¸‚é€šè¿‡èˆªç­ç›¸è¿žã€‚è¿™äº›èˆªç­ç”¨ N*N çŸ©é˜µ flightsï¼ˆä¸ä¸€å®šæ˜¯å¯¹ç§°çš„ï¼‰è¡¨ç¤ºï¼Œflights[i][j] ä»£è¡¨åŸŽå¸‚iåˆ°åŸŽå¸‚jçš„èˆªç©ºçŠ¶æ€ã€‚å¦‚æžœæ²¡æœ‰åŸŽ
# å¸‚iåˆ°åŸŽå¸‚jçš„èˆªç­ï¼Œflights[i][j] = 0ï¼›å¦åˆ™ï¼Œflights[i][j] = 1ã€‚åŒæ—¶ï¼Œå¯¹äºŽæ‰€æœ‰çš„iï¼Œflights[i][i] = 0ã€‚
#  æ‚¨æ€»å…±æœ‰ K å‘¨ï¼ˆæ¯å‘¨7å¤©ï¼‰çš„æ—¶é—´æ—…è¡Œã€‚æ‚¨æ¯å¤©æœ€å¤šåªèƒ½ä¹˜åä¸€æ¬¡èˆªç­ï¼Œå¹¶ä¸”åªèƒ½åœ¨æ¯å‘¨çš„æ˜ŸæœŸä¸€ä¸Šåˆä¹˜åèˆªç­ã€‚ç”±äºŽé£žè¡Œæ—¶é—´å¾ˆçŸ­ï¼Œæˆ‘ä»¬ä¸è€ƒè™‘é£žè¡Œæ—¶é—´çš„å½±å“ã€‚
#  å¯¹äºŽæ¯ä¸ªåŸŽå¸‚ï¼Œä¸åŒçš„æ˜ŸæœŸæ‚¨ä¼‘å‡å¤©æ•°æ˜¯ä¸åŒçš„ï¼Œç»™å®šä¸€ä¸ª N*K çŸ©é˜µ days ä»£è¡¨è¿™ç§é™åˆ¶ï¼Œdays[i][j] ä»£è¡¨æ‚¨åœ¨ç¬¬jä¸ªæ˜ŸæœŸåœ¨åŸŽå¸‚ièƒ½ä¼‘å‡çš„æœ€é•¿å¤©
# æ•°ã€‚
#
#
#  ç»™å®š flights çŸ©é˜µå’Œ days çŸ©é˜µï¼Œæ‚¨éœ€è¦è¾“å‡º K å‘¨å†…å¯ä»¥ä¼‘å‡çš„æœ€é•¿å¤©æ•°ã€‚
#
#  ç¤ºä¾‹ 1:
#
#  è¾“å…¥:flights = [[0,1,1],[1,0,1],[1,1,0]], days = [[1,3,1],[6,0,3],[3,3,3]]
# è¾“å‡º: 12
# è§£é‡Š:
# Ans = 6 + 3 + 3 = 12.
#
# æœ€å¥½çš„ç­–ç•¥ä¹‹ä¸€ï¼š
# ç¬¬ä¸€ä¸ªæ˜ŸæœŸ : æ˜ŸæœŸä¸€ä»ŽåŸŽå¸‚0é£žåˆ°åŸŽå¸‚1ï¼ŒçŽ©6å¤©ï¼Œå·¥ä½œ1å¤©ã€‚
# ï¼ˆè™½ç„¶ä½ æ˜¯ä»ŽåŸŽå¸‚0å¼€å§‹ï¼Œä½†å› ä¸ºæ˜¯æ˜ŸæœŸä¸€ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é£žåˆ°å…¶ä»–åŸŽå¸‚ã€‚ï¼‰
# ç¬¬äºŒä¸ªæ˜ŸæœŸ : æ˜ŸæœŸä¸€ä»ŽåŸŽå¸‚1é£žåˆ°åŸŽå¸‚2ï¼ŒçŽ©3å¤©ï¼Œå·¥ä½œ4å¤©ã€‚
# ç¬¬ä¸‰ä¸ªæ˜ŸæœŸ : å‘†åœ¨åŸŽå¸‚2ï¼ŒçŽ©3å¤©ï¼Œå·¥ä½œ4å¤©ã€‚
#
#
#
#
#  ç¤ºä¾‹ 2:
#
#  è¾“å…¥:flights = [[0,0,0],[0,0,0],[0,0,0]], days = [[1,1,1],[7,7,7],[7,7,7]]
# è¾“å‡º: 3
# è§£é‡Š:
# Ans = 1 + 1 + 1 = 3.
#
# ç”±äºŽæ²¡æœ‰èˆªç­å¯ä»¥è®©æ‚¨é£žåˆ°å…¶ä»–åŸŽå¸‚ï¼Œä½ å¿…é¡»åœ¨åŸŽå¸‚0å‘†æ•´æ•´3ä¸ªæ˜ŸæœŸã€‚
# å¯¹äºŽæ¯ä¸€ä¸ªæ˜ŸæœŸï¼Œä½ åªæœ‰ä¸€å¤©æ—¶é—´çŽ©ï¼Œå‰©ä¸‹å…­å¤©éƒ½è¦å·¥ä½œã€‚
# æ‰€ä»¥æœ€å¤§ä¼‘å‡å¤©æ•°ä¸º3.
#
#
#
#
#  ç¤ºä¾‹ 3:
#
#  è¾“å…¥:flights = [[0,1,1],[1,0,1],[1,1,0]], days = [[7,0,0],[0,7,0],[0,0,7]]
# è¾“å‡º: 21
# è§£é‡Š:
# Ans = 7 + 7 + 7 = 21
#
# æœ€å¥½çš„ç­–ç•¥ä¹‹ä¸€æ˜¯ï¼š
# ç¬¬ä¸€ä¸ªæ˜ŸæœŸ : å‘†åœ¨åŸŽå¸‚0ï¼ŒçŽ©7å¤©ã€‚
# ç¬¬äºŒä¸ªæ˜ŸæœŸ : æ˜ŸæœŸä¸€ä»ŽåŸŽå¸‚0é£žåˆ°åŸŽå¸‚1ï¼ŒçŽ©7å¤©ã€‚
# ç¬¬ä¸‰ä¸ªæ˜ŸæœŸ : æ˜ŸæœŸä¸€ä»ŽåŸŽå¸‚1é£žåˆ°åŸŽå¸‚2ï¼ŒçŽ©7å¤©ã€‚
#
#
#
#
#  æ³¨æ„:
#
#
#  N å’Œ K éƒ½æ˜¯æ­£æ•´æ•°ï¼Œåœ¨ [1, 100] èŒƒå›´å†…ã€‚
#  çŸ©é˜µ flights çš„æ‰€æœ‰å€¼éƒ½æ˜¯ [0, 1] èŒƒå›´å†…çš„æ•´æ•°ã€‚
#  çŸ©é˜µ days çš„æ‰€æœ‰å€¼éƒ½æ˜¯ [0, 7] èŒƒå›´å†…çš„æ•´æ•°ã€‚
#  è¶…è¿‡ä¼‘å‡å¤©æ•°æ‚¨ä»å¯ä»¥å‘†åœ¨é‚£ä¸ªåŸŽå¸‚ï¼Œä½†æ˜¯åœ¨é¢å¤–çš„æ—¥å­æ‚¨éœ€è¦ å·¥ä½œ ï¼Œè¿™äº›æ—¥å­ä¸ä¼šç®—åšä¼‘å‡æ—¥ã€‚
#  å¦‚æžœæ‚¨ä»ŽåŸŽå¸‚Aé£žå¾€åŸŽå¸‚Bå¹¶åœ¨å½“å¤©ä¼‘å‡æ—¥ï¼Œè¿™ä¸ªä¼‘å‡ä¼šè¢«ç®—ä½œæ˜¯åŸŽå¸‚Bçš„ä¼‘å‡æ—¥ã€‚
#  æˆ‘ä»¬ä¸è€ƒè™‘é£žè¡Œæ—¶é—´å¯¹è®¡ç®—ä¼‘å‡æ—¥çš„å½±å“ã€‚
#
#
#
#  Related Topics æ•°ç»„ åŠ¨æ€è§„åˆ’ çŸ©é˜µ
#  ðŸ‘ 35 ðŸ‘Ž 0


class Solution:
    def maxVacationDays(self, flights: List[List[int]], days: List[List[int]]) -> int:
        g = collections.defaultdict(list)
        R, C = len(flights), len(flights[0])
        for r in range(R):
            g[r].append(r)
            for c in range(C):
                if flights[r][c] == 1:
                    g[r].append(c)
        dp = [0] * R
        weeks = len(days[0])
        t = [0]
        for week in range(1, weeks + 1):
            tree = []
            tmpdp = dp[:]
            for city in t:
                for nxt in g[city]:
                    tmpdp[nxt] = max(tmpdp[nxt], dp[city] + days[nxt][week - 1])
                    tree.append(nxt)
            dp = tmpdp[:]
            t = list(set(tree))
        return max(dp)


Solution().maxVacationDays([[0, 1, 1], [1, 0, 1], [1, 1, 0]], [[1, 3, 1], [6, 0, 3], [3, 3, 3]])

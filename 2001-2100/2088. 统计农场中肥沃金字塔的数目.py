# -*- coding: utf-8 -*-
# æœ‰ä¸€ä¸ª çŸ©å½¢ç½‘æ ¼ çŠ¶çš„å†œåœºï¼Œåˆ’åˆ†ä¸º m è¡Œ n åˆ—çš„å•å…ƒæ ¼ã€‚æ¯ä¸ªæ ¼å­è¦ä¹ˆæ˜¯ è‚¥æ²ƒçš„ ï¼ˆç”¨ 1 è¡¨ç¤ºï¼‰ï¼Œè¦ä¹ˆæ˜¯ è´«ç˜  çš„ï¼ˆç”¨ 0 è¡¨ç¤ºï¼‰ã€‚ç½‘æ ¼å›¾ä»¥å¤–çš„æ‰€æœ‰ä¸æ ¼
# å­éƒ½è§†ä¸ºè´«ç˜ çš„ã€‚
#
#  å†œåœºä¸­çš„ é‡‘å­—å¡” åŒºåŸŸå®šä¹‰å¦‚ä¸‹ï¼š
#
#
#  åŒºåŸŸå†…æ ¼å­æ•°ç›® å¤§äº 1 ä¸”æ‰€æœ‰æ ¼å­éƒ½æ˜¯ è‚¥æ²ƒçš„ ã€‚
#  é‡‘å­—å¡” é¡¶ç«¯ æ˜¯è¿™ä¸ªé‡‘å­—å¡” æœ€ä¸Šæ–¹ çš„æ ¼å­ã€‚é‡‘å­—å¡”çš„é«˜åº¦æ˜¯å®ƒæ‰€è¦†ç›–çš„è¡Œæ•°ã€‚ä»¤ (r, c) ä¸ºé‡‘å­—å¡”çš„é¡¶ç«¯ä¸”é«˜åº¦ä¸º h ï¼Œé‚£ä¹ˆé‡‘å­—å¡”åŒºåŸŸå†…åŒ…å«çš„ä»»ä¸€æ ¼å­
# (i, j) éœ€æ»¡è¶³ r <= i <= r + h - 1 ä¸” c - (i - r) <= j <= c + (i - r) ã€‚
#
#
#  ä¸€ä¸ª å€’é‡‘å­—å¡” ç±»ä¼¼å®šä¹‰å¦‚ä¸‹ï¼š
#
#
#  åŒºåŸŸå†…æ ¼å­æ•°ç›® å¤§äº 1 ä¸”æ‰€æœ‰æ ¼å­éƒ½æ˜¯ è‚¥æ²ƒçš„ ã€‚
#  å€’é‡‘å­—å¡”çš„ é¡¶ç«¯ æ˜¯è¿™ä¸ªå€’é‡‘å­—å¡” æœ€ä¸‹æ–¹ çš„æ ¼å­ã€‚å€’é‡‘å­—å¡”çš„é«˜åº¦æ˜¯å®ƒæ‰€è¦†ç›–çš„è¡Œæ•°ã€‚ä»¤ (r, c) ä¸ºé‡‘å­—å¡”çš„é¡¶ç«¯ä¸”é«˜åº¦ä¸º h ï¼Œé‚£ä¹ˆé‡‘å­—å¡”åŒºåŸŸå†…åŒ…å«çš„ä»»
# ä¸€æ ¼å­ (i, j) éœ€æ»¡è¶³ r - h + 1 <= i <= r ä¸” c - (r - i) <= j <= c + (r - i) ã€‚
#
#
#  ä¸‹å›¾å±•ç¤ºäº†éƒ¨åˆ†ç¬¦åˆå®šä¹‰å’Œä¸ç¬¦åˆå®šä¹‰çš„é‡‘å­—å¡”åŒºåŸŸã€‚é»‘è‰²åŒºåŸŸè¡¨ç¤ºè‚¥æ²ƒçš„æ ¼å­ã€‚
#
#
#
#  ç»™ä½ ä¸€ä¸ªä¸‹æ ‡ä» 0 å¼€å§‹ä¸”å¤§å°ä¸º m x n çš„äºŒè¿›åˆ¶çŸ©é˜µ grid ï¼Œå®ƒè¡¨ç¤ºå†œåœºï¼Œè¯·ä½ è¿”å› grid ä¸­é‡‘å­—å¡”å’Œå€’é‡‘å­—å¡”çš„ æ€»æ•°ç›® ã€‚
#
#
#
#  ç¤ºä¾‹ 1ï¼š
#
#
#
#  è¾“å…¥ï¼šgrid = [[0,1,1,0],[1,1,1,1]]
# è¾“å‡ºï¼š2
# è§£é‡Šï¼š
# 2 ä¸ªå¯èƒ½çš„é‡‘å­—å¡”åŒºåŸŸåˆ†åˆ«å¦‚ä¸Šå›¾è“è‰²å’Œçº¢è‰²åŒºåŸŸæ‰€ç¤ºã€‚
# è¿™ä¸ªç½‘æ ¼å›¾ä¸­æ²¡æœ‰å€’é‡‘å­—å¡”åŒºåŸŸã€‚
# æ‰€ä»¥é‡‘å­—å¡”åŒºåŸŸæ€»æ•°ä¸º 2 + 0 = 2 ã€‚
#
#
#  ç¤ºä¾‹ 2ï¼š
#
#
#
#  è¾“å…¥ï¼šgrid = [[1,1,1],[1,1,1]]
# è¾“å‡ºï¼š2
# è§£é‡Šï¼š
# é‡‘å­—å¡”åŒºåŸŸå¦‚ä¸Šå›¾è“è‰²åŒºåŸŸæ‰€ç¤ºï¼Œå€’é‡‘å­—å¡”å¦‚ä¸Šå›¾çº¢è‰²åŒºåŸŸæ‰€ç¤ºã€‚
# æ‰€ä»¥é‡‘å­—å¡”åŒºåŸŸæ€»æ•°ç›®ä¸º 1 + 1 = 2 ã€‚
#
#
#  ç¤ºä¾‹ 3ï¼š
#
#
#
#  è¾“å…¥ï¼šgrid = [[1,0,1],[0,0,0],[1,0,1]]
# è¾“å‡ºï¼š0
# è§£é‡Šï¼š
# ç½‘æ ¼å›¾ä¸­æ²¡æœ‰ä»»ä½•é‡‘å­—å¡”æˆ–å€’é‡‘å­—å¡”åŒºåŸŸã€‚
#
#
#  ç¤ºä¾‹ 4ï¼š
#
#
#
#  è¾“å…¥ï¼šgrid = [[1,1,1,1,0],[1,1,1,1,1],[1,1,1,1,1],[0,1,0,0,1]]
# è¾“å‡ºï¼š13
# è§£é‡Šï¼š
# æœ‰ 7 ä¸ªé‡‘å­—å¡”åŒºåŸŸã€‚ä¸Šå›¾ç¬¬äºŒå’Œç¬¬ä¸‰å¼ å›¾ä¸­å±•ç¤ºäº†å®ƒä»¬ä¸­çš„ 3 ä¸ªã€‚
# æœ‰ 6 ä¸ªå€’é‡‘å­—å¡”åŒºåŸŸã€‚ä¸Šå›¾ä¸­æœ€åä¸€å¼ å›¾å±•ç¤ºäº†å®ƒä»¬ä¸­çš„ 2 ä¸ªã€‚
# æ‰€ä»¥é‡‘å­—å¡”åŒºåŸŸæ€»æ•°ç›®ä¸º 7 + 6 = 13.
#
#
#
#
#  æç¤ºï¼š
#
#
#  m == grid.length
#  n == grid[i].length
#  1 <= m, n <= 1000
#  1 <= m * n <= 10âµ
#  grid[i][j] è¦ä¹ˆæ˜¯ 0 ï¼Œè¦ä¹ˆæ˜¯ 1 ã€‚
#
#
#  Related Topics æ•°ç»„ åŠ¨æ€è§„åˆ’ çŸ©é˜µ
#  ğŸ‘ 22 ğŸ‘ 0


# leetcode submit region begin(Prohibit modification and deletion)
class Solution:
    def countPyramids(self, grid: List[List[int]]) -> int:
        R, C = len(grid), len(grid[0])
        dp = [[0] * C for _ in range(R)]
        ans = 0
        # æ­£é‡‘å­—å¡”
        for r in range(R - 1, -1, -1):
            for c in range(C):
                if grid[r][c] == 0:
                    dp[r][c] = -1
                elif r == R - 1 or c == 0 or c == C - 1:
                    dp[r][c] = 0
                else:
                    dp[r][c] = min(dp[r + 1][c - 1], dp[r + 1][c], dp[r + 1][c + 1]) + 1
                    ans += dp[r][c]
        # å€’é‡‘å­—å¡”
        for r in range(R):
            for c in range(C):
                if grid[r][c] == 0:
                    dp[r][c] = -1
                elif r == 0 or c == 0 or c == C - 1:
                    dp[r][c] = 0
                else:
                    dp[r][c] = min(dp[r - 1][c - 1], dp[r - 1][c], dp[r - 1][c + 1]) + 1
                    ans+=dp[r][c]
        return ans
# leetcode submit region end(Prohibit modification and deletion)

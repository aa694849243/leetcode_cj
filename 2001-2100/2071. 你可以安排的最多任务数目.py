# -*- coding: utf-8 -*-
# Áªô‰Ω† n ‰∏™‰ªªÂä°Âíå m ‰∏™Â∑•‰∫∫„ÄÇÊØè‰∏™‰ªªÂä°ÈúÄË¶Å‰∏ÄÂÆöÁöÑÂäõÈáèÂÄºÊâçËÉΩÂÆåÊàêÔºåÈúÄË¶ÅÁöÑÂäõÈáèÂÄº‰øùÂ≠òÂú®‰∏ãÊ†á‰ªé 0 ÂºÄÂßãÁöÑÊï¥Êï∞Êï∞ÁªÑ tasks ‰∏≠ÔºåÁ¨¨ i ‰∏™‰ªªÂä°ÈúÄË¶Å
# tasks[i] ÁöÑÂäõÈáèÊâçËÉΩÂÆåÊàê„ÄÇÊØè‰∏™Â∑•‰∫∫ÁöÑÂäõÈáèÂÄº‰øùÂ≠òÂú®‰∏ãÊ†á‰ªé 0 ÂºÄÂßãÁöÑÊï¥Êï∞Êï∞ÁªÑ workers ‰∏≠ÔºåÁ¨¨ j ‰∏™Â∑•‰∫∫ÁöÑÂäõÈáèÂÄº‰∏∫ workers[j] „ÄÇÊØè‰∏™Â∑•‰∫∫Âè™ËÉΩÂÆå
# Êàê ‰∏Ä‰∏™ ‰ªªÂä°Ôºå‰∏îÂäõÈáèÂÄºÈúÄË¶Å Â§ß‰∫éÁ≠â‰∫é ËØ•‰ªªÂä°ÁöÑÂäõÈáèË¶ÅÊ±ÇÂÄºÔºàÂç≥ workers[j] >= tasks[i] Ôºâ„ÄÇ
#
#  Èô§Ê≠§‰ª•Â§ñÔºå‰Ω†ËøòÊúâ pills ‰∏™Á•ûÂ•áËçØ‰∏∏ÔºåÂèØ‰ª•Áªô ‰∏Ä‰∏™Â∑•‰∫∫ÁöÑÂäõÈáèÂÄº Â¢ûÂä† strength „ÄÇ‰Ω†ÂèØ‰ª•ÂÜ≥ÂÆöÁªôÂì™‰∫õÂ∑•‰∫∫‰ΩøÁî®ËçØ‰∏∏Ôºå‰ΩÜÊØè‰∏™Â∑•‰∫∫ ÊúÄÂ§ö Âè™ËÉΩ‰ΩøÁî® ‰∏Ä
# Áâá ËçØ‰∏∏„ÄÇ
#
#  Áªô‰Ω†‰∏ãÊ†á‰ªé 0 ÂºÄÂßãÁöÑÊï¥Êï∞Êï∞ÁªÑtasks Âíå workers ‰ª•Âèä‰∏§‰∏™Êï¥Êï∞ pills Âíå strength ÔºåËØ∑‰Ω†ËøîÂõû ÊúÄÂ§ö ÊúâÂ§öÂ∞ë‰∏™‰ªªÂä°ÂèØ‰ª•Ë¢´ÂÆåÊàê„ÄÇ
#
#
#
#
#  Á§∫‰æã 1Ôºö
#
#  ËæìÂÖ•Ôºötasks = [3,2,1], workers = [0,3,3], pills = 1, strength = 1
# ËæìÂá∫Ôºö3
# Ëß£ÈáäÔºö
# Êàë‰ª¨ÂèØ‰ª•ÊåâÁÖßÂ¶Ç‰∏ãÊñπÊ°àÂÆâÊéíËçØ‰∏∏Ôºö
# - Áªô 0 Âè∑Â∑•‰∫∫ËçØ‰∏∏„ÄÇ
# - 0 Âè∑Â∑•‰∫∫ÂÆåÊàê‰ªªÂä° 2Ôºà0 + 1 >= 1Ôºâ
# - 1 Âè∑Â∑•‰∫∫ÂÆåÊàê‰ªªÂä° 1Ôºà3 >= 2Ôºâ
# - 2 Âè∑Â∑•‰∫∫ÂÆåÊàê‰ªªÂä° 0Ôºà3 >= 3Ôºâ
#
#
#  Á§∫‰æã 2Ôºö
#
#  ËæìÂÖ•Ôºötasks = [5,4], workers = [0,0,0], pills = 1, strength = 5
# ËæìÂá∫Ôºö1
# Ëß£ÈáäÔºö
# Êàë‰ª¨ÂèØ‰ª•ÊåâÁÖßÂ¶Ç‰∏ãÊñπÊ°àÂÆâÊéíËçØ‰∏∏Ôºö
# - Áªô 0 Âè∑Â∑•‰∫∫ËçØ‰∏∏„ÄÇ
# - 0 Âè∑Â∑•‰∫∫ÂÆåÊàê‰ªªÂä° 0Ôºà0 + 5 >= 5Ôºâ
#
#
#  Á§∫‰æã 3Ôºö
#
#  ËæìÂÖ•Ôºötasks = [10,15,30], workers = [0,10,10,10,10], pills = 3, strength = 10
# ËæìÂá∫Ôºö2
# Ëß£ÈáäÔºö
# Êàë‰ª¨ÂèØ‰ª•ÊåâÁÖßÂ¶Ç‰∏ãÊñπÊ°àÂÆâÊéíËçØ‰∏∏Ôºö
# - Áªô 0 Âè∑Âíå 1 Âè∑Â∑•‰∫∫ËçØ‰∏∏„ÄÇ
# - 0 Âè∑Â∑•‰∫∫ÂÆåÊàê‰ªªÂä° 0Ôºà0 + 10 >= 10Ôºâ
# - 1 Âè∑Â∑•‰∫∫ÂÆåÊàê‰ªªÂä° 1Ôºà10 + 10 >= 15Ôºâ
#
#
#  Á§∫‰æã 4Ôºö
#
#  ËæìÂÖ•Ôºötasks = [5,9,8,5,9], workers = [1,6,4,2,6], pills = 1, strength = 5
# ËæìÂá∫Ôºö3
# Ëß£ÈáäÔºö
# Êàë‰ª¨ÂèØ‰ª•ÊåâÁÖßÂ¶Ç‰∏ãÊñπÊ°àÂÆâÊéíËçØ‰∏∏Ôºö
# - Áªô 2 Âè∑Â∑•‰∫∫ËçØ‰∏∏„ÄÇ
# - 1 Âè∑Â∑•‰∫∫ÂÆåÊàê‰ªªÂä° 0Ôºà6 >= 5Ôºâ
# - 2 Âè∑Â∑•‰∫∫ÂÆåÊàê‰ªªÂä° 2Ôºà4 + 5 >= 8Ôºâ
# - 4 Âè∑Â∑•‰∫∫ÂÆåÊàê‰ªªÂä° 3Ôºà6 >= 5Ôºâ
#
#
#
#
#  ÊèêÁ§∫Ôºö
#
#
#  n == tasks.length
#  m == workers.length
#  1 <= n, m <= 5 * 10‚Å¥
#  0 <= pills <= m
#  0 <= tasks[i], workers[j], strength <= 10‚Åπ
#
#
#  Related Topics Ë¥™ÂøÉ ÈòüÂàó Êï∞ÁªÑ ‰∫åÂàÜÊü•Êâæ ÊéíÂ∫è ÂçïË∞ÉÈòüÂàó
#  üëç 51 üëé 0

from typing import List
import collections
# leetcode submit region begin(Prohibit modification and deletion)
class Solution:
    def maxTaskAssign(self, tasks: List[int], workers: List[int], pills: int, strength: int) -> int:
        n, m = len(tasks), len(workers)
        tasks.sort()
        workers.sort()

        def check(num):
            ws = collections.deque()
            p = pills
            ptr = m - 1
            for i in range(num - 1, -1, -1):
                while ptr >= m - num and workers[ptr] + strength >= tasks[i]:
                    ws.appendleft(workers[ptr])
                    ptr -= 1
                if not ws:
                    return False
                if ws[-1] >= tasks[i]:
                    ws.pop()
                else:
                    if p:
                        p -= 1
                        ws.popleft()
                    else:
                        return False
            return True

        l = 0
        r = min(m, n) + 1
        while l<r:
            mid=(l+r)//2
            if check(mid):
                l=mid+1
            else:
                r=mid
        return l-1

# leetcode submit region end(Prohibit modification and deletion)
print(Solution().maxTaskAssign([3,2,1], [0,3,3], 1, 1))
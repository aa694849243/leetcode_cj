# æˆ‘ä»¬å°†ç»™å®šçš„æ•°ç»„ A åˆ†æˆ K ä¸ªç›¸é‚»çš„éç©ºå­æ•°ç»„ ï¼Œæˆ‘ä»¬çš„åˆ†æ•°ç”±æ¯ä¸ªå­æ•°ç»„å†…çš„å¹³å‡å€¼çš„æ€»å’Œæ„æˆã€‚è®¡ç®—æˆ‘ä»¬æ‰€èƒ½å¾—åˆ°çš„æœ€å¤§åˆ†æ•°æ˜¯å¤šå°‘ã€‚
#
#  æ³¨æ„æˆ‘ä»¬å¿…é¡»ä½¿ç”¨ A æ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªæ•°è¿›è¡Œåˆ†ç»„ï¼Œå¹¶ä¸”åˆ†æ•°ä¸ä¸€å®šéœ€è¦æ˜¯æ•´æ•°ã€‚
#
#
# ç¤ºä¾‹:
# è¾“å…¥:
# A = [9,1,2,3,9]
# K = 3
# è¾“å‡º: 20
# è§£é‡Š:
# A çš„æœ€ä¼˜åˆ†ç»„æ˜¯[9], [1, 2, 3], [9]. å¾—åˆ°çš„åˆ†æ•°æ˜¯ 9 + (1 + 2 + 3) / 3 + 9 = 20.
# æˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠ A åˆ†æˆ[9, 1], [2], [3, 9].
# è¿™æ ·çš„åˆ†ç»„å¾—åˆ°çš„åˆ†æ•°ä¸º 5 + 2 + 6 = 13, ä½†ä¸æ˜¯æœ€å¤§å€¼.
#
#
#  è¯´æ˜:
#
#
#  1 <= A.length <= 100.
#  1 <= A[i] <= 10000.
#  1 <= K <= A.length.
#  ç­”æ¡ˆè¯¯å·®åœ¨ 10^-6 å†…è¢«è§†ä¸ºæ˜¯æ­£ç¡®çš„ã€‚
#
#  Related Topics åŠ¨æ€è§„åˆ’
#  ğŸ‘ 166 ğŸ‘ 0

from typing import List
import itertools


class Solution:
    def largestSumOfAverages(self, A: List[int], K: int) -> float:
        P = [0] + [*itertools.accumulate(A)]

        def average(i, j):  # æœ€é«˜j==n,i==n-1
            return (P[j] - P[i]) / (j - i)

        n = len(A)
        dp = [average(i, n) for i in range(n)] + [0]
        for k in range(K - 1):
            ndp = [0] * len(dp)
            for i in range(n - 1, -1, -1):
                # average(i,j)ä¸ºiåˆ°j-1çš„å¹³å‡å€¼
                ndp[i] = max(dp[j] + average(i, j) for j in range(i+1, n + 1))
            dp = ndp
        return dp[0]


Solution().largestSumOfAverages([9, 1, 2, 3, 9], 3)

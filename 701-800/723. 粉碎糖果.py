#!/usr/bin/env python
# -*- coding: utf-8 -*-
from typing import List


# è¿™ä¸ªé—®é¢˜æ˜¯å®žçŽ°ä¸€ä¸ªç®€å•çš„æ¶ˆé™¤ç®—æ³•ã€‚
#
#  ç»™å®šä¸€ä¸ªäºŒç»´æ•´æ•°æ•°ç»„ board ä»£è¡¨ç³–æžœæ‰€åœ¨çš„æ–¹æ ¼ï¼Œä¸åŒçš„æ­£æ•´æ•° board[i][j] ä»£è¡¨ä¸åŒç§ç±»çš„ç³–æžœï¼Œå¦‚æžœ board[i][j] = 0 ä»£è¡¨
#  (i, j) è¿™ä¸ªä½ç½®æ˜¯ç©ºçš„ã€‚ç»™å®šçš„æ–¹æ ¼æ˜¯çŽ©å®¶ç§»åŠ¨åŽçš„æ¸¸æˆçŠ¶æ€ï¼ŒçŽ°åœ¨éœ€è¦ä½ æ ¹æ®ä»¥ä¸‹è§„åˆ™ç²‰ç¢Žç³–æžœï¼Œä½¿å¾—æ•´ä¸ªæ–¹æ ¼å¤„äºŽç¨³å®šçŠ¶æ€å¹¶æœ€ç»ˆè¾“å‡ºã€‚
#
#
#  å¦‚æžœæœ‰ä¸‰ä¸ªåŠä»¥ä¸Šæ°´å¹³æˆ–è€…åž‚ç›´ç›¸è¿žçš„åŒç§ç³–æžœï¼ŒåŒä¸€æ—¶é—´å°†å®ƒä»¬ç²‰ç¢Žï¼Œå³å°†è¿™äº›ä½ç½®å˜æˆç©ºçš„ã€‚
#  åœ¨åŒæ—¶ç²‰ç¢ŽæŽ‰è¿™äº›ç³–æžœä¹‹åŽï¼Œå¦‚æžœæœ‰ä¸€ä¸ªç©ºçš„ä½ç½®ä¸Šæ–¹è¿˜æœ‰ç³–æžœï¼Œé‚£ä¹ˆä¸Šæ–¹çš„ç³–æžœå°±ä¼šä¸‹è½ç›´åˆ°ç¢°åˆ°ä¸‹æ–¹çš„ç³–æžœæˆ–è€…åº•éƒ¨ï¼Œè¿™äº›ç³–æžœéƒ½æ˜¯åŒæ—¶ä¸‹è½ï¼Œä¹Ÿä¸ä¼šæœ‰æ–°çš„ç³–æžœä»Žé¡¶éƒ¨å‡º
# çŽ°å¹¶è½ä¸‹æ¥ã€‚
#  é€šè¿‡å‰ä¸¤æ­¥çš„æ“ä½œï¼Œå¯èƒ½åˆä¼šå‡ºçŽ°å¯ä»¥ç²‰ç¢Žçš„ç³–æžœï¼Œè¯·ç»§ç»­é‡å¤å‰é¢çš„æ“ä½œã€‚
#  å½“ä¸å­˜åœ¨å¯ä»¥ç²‰ç¢Žçš„ç³–æžœï¼Œä¹Ÿå°±æ˜¯çŠ¶æ€ç¨³å®šä¹‹åŽï¼Œè¯·è¾“å‡ºæœ€ç»ˆçš„çŠ¶æ€ã€‚
#
#
#  ä½ éœ€è¦æ¨¡æ‹Ÿä¸Šè¿°è§„åˆ™å¹¶ä½¿æ•´ä¸ªæ–¹æ ¼è¾¾åˆ°ç¨³å®šçŠ¶æ€ï¼Œå¹¶è¾“å‡ºã€‚
#
#
#
#  æ ·ä¾‹ :
#
#  è¾“å…¥:
# board =
# [[110,5,112,113,114],[210,211,5,213,214],[310,311,3,313,314],[410,411,412,5,41
# 4],[5,1,512,3,3],[610,4,1,613,614],[710,1,2,713,714],[810,1,2,1,1],[1,1,2,2,2],[
# 4,1,4,4,1014]]
#
# è¾“å‡º:
# [[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0],[110,0,0,0,114],[210,0,0,0,214],[310,0,0,
# 113,314],[410,0,0,213,414],[610,211,112,313,614],[710,311,412,613,714],[810,411,
# 512,713,1014]]
#
# è§£é‡Š:
#
#
#
#
#
#  æ³¨é‡Š :
#
#
#  board æ•°ç»„çš„è¡Œæ•°åŒºé—´æ˜¯ [3, 50]ã€‚
#  board[i] æ•°ç»„çš„é•¿åº¦åŒºé—´ï¼ˆå³ board æ•°ç»„çš„åˆ—æ•°åŒºé—´ï¼‰æ˜¯ [3, 50]ã€‚
#  æ¯ä¸ª board[i][j] åˆå§‹æ•´æ•°èŒƒå›´æ˜¯ [1, 2000]ã€‚
#
#  Related Topics æ•°ç»„ åŒæŒ‡é’ˆ çŸ©é˜µ æ¨¡æ‹Ÿ
#  ðŸ‘ 67 ðŸ‘Ž 0


class Solution:
    def candyCrush(self, board: List[List[int]]) -> List[List[int]]:
        R, C = len(board), len(board[0])
        todo = False
        for r in range(R):
            for c in range(C - 2):
                if abs(board[r][c]) == abs(board[r][c + 1]) == abs(board[r][c + 2]) != 0:
                    board[r][c] = board[r][c + 1] = board[r][c + 2] = -abs(board[r][c])
                    todo = True
        for c in range(C):
            for r in range(R - 2):
                if abs(board[r][c]) == abs(board[r + 1][c]) == abs(board[r + 2][c]) != 0:
                    board[r][c] = board[r + 1][c] = board[r + 2][c] = -abs(board[r][c])
                    todo = True
        for c in range(C):
            wr = R - 1
            for r in range(R - 1, -1, -1):
                if board[r][c] > 0:
                    board[wr][c] = board[r][c]
                    wr -= 1
            for r in range(wr,-1,-1):
                board[r][c]=0
        return self.candyCrush(board) if todo else board

# -*- coding: utf-8 -*-
#
#
#  äºŒæŒ‡è¾“å…¥æ³•å®šåˆ¶é”®ç›˜åœ¨ XY å¹³é¢ä¸Šçš„å¸ƒå±€å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå…¶ä¸­æ¯ä¸ªå¤§å†™è‹±æ–‡å­—æ¯éƒ½ä½äºæŸä¸ªåæ ‡å¤„ï¼Œä¾‹å¦‚å­—æ¯ A ä½äºåæ ‡ (0,0)ï¼Œå­—æ¯ B ä½äºåæ ‡ (0,1
# )ï¼Œå­—æ¯ P ä½äºåæ ‡ (2,3) ä¸”å­—æ¯ Z ä½äºåæ ‡ (4,1)ã€‚
#
#  ç»™ä½ ä¸€ä¸ªå¾…è¾“å…¥å­—ç¬¦ä¸² wordï¼Œè¯·ä½ è®¡ç®—å¹¶è¿”å›åœ¨ä»…ä½¿ç”¨ä¸¤æ ¹æ‰‹æŒ‡çš„æƒ…å†µä¸‹ï¼Œé”®å…¥è¯¥å­—ç¬¦ä¸²éœ€è¦çš„æœ€å°ç§»åŠ¨æ€»è·ç¦»ã€‚åæ ‡ (x1,y1) å’Œ (x2,y2) ä¹‹é—´çš„
# è·ç¦»æ˜¯ |x1 - x2| + |y1 - y2|ã€‚
#
#  æ³¨æ„ï¼Œä¸¤æ ¹æ‰‹æŒ‡çš„èµ·å§‹ä½ç½®æ˜¯é›¶ä»£ä»·çš„ï¼Œä¸è®¡å…¥ç§»åŠ¨æ€»è·ç¦»ã€‚ä½ çš„ä¸¤æ ¹æ‰‹æŒ‡çš„èµ·å§‹ä½ç½®ä¹Ÿä¸å¿…ä»é¦–å­—æ¯æˆ–è€…å‰ä¸¤ä¸ªå­—æ¯å¼€å§‹ã€‚
#
#
#
#  ç¤ºä¾‹ 1ï¼š
#
#  è¾“å…¥ï¼šword = "CAKE"
# è¾“å‡ºï¼š3
# è§£é‡Šï¼š
# ä½¿ç”¨ä¸¤æ ¹æ‰‹æŒ‡è¾“å…¥ "CAKE" çš„æœ€ä½³æ–¹æ¡ˆä¹‹ä¸€æ˜¯ï¼š
# æ‰‹æŒ‡ 1 åœ¨å­—æ¯ 'C' ä¸Š -> ç§»åŠ¨è·ç¦» = 0
# æ‰‹æŒ‡ 1 åœ¨å­—æ¯ 'A' ä¸Š -> ç§»åŠ¨è·ç¦» = ä»å­—æ¯ 'C' åˆ°å­—æ¯ 'A' çš„è·ç¦» = 2
# æ‰‹æŒ‡ 2 åœ¨å­—æ¯ 'K' ä¸Š -> ç§»åŠ¨è·ç¦» = 0
# æ‰‹æŒ‡ 2 åœ¨å­—æ¯ 'E' ä¸Š -> ç§»åŠ¨è·ç¦» = ä»å­—æ¯ 'K' åˆ°å­—æ¯ 'E' çš„è·ç¦»  = 1
# æ€»è·ç¦» = 3
#
#
#  ç¤ºä¾‹ 2ï¼š
#
#  è¾“å…¥ï¼šword = "HAPPY"
# è¾“å‡ºï¼š6
# è§£é‡Šï¼š
# ä½¿ç”¨ä¸¤æ ¹æ‰‹æŒ‡è¾“å…¥ "HAPPY" çš„æœ€ä½³æ–¹æ¡ˆä¹‹ä¸€æ˜¯ï¼š
# æ‰‹æŒ‡ 1 åœ¨å­—æ¯ 'H' ä¸Š -> ç§»åŠ¨è·ç¦» = 0
# æ‰‹æŒ‡ 1 åœ¨å­—æ¯ 'A' ä¸Š -> ç§»åŠ¨è·ç¦» = ä»å­—æ¯ 'H' åˆ°å­—æ¯ 'A' çš„è·ç¦» = 2
# æ‰‹æŒ‡ 2 åœ¨å­—æ¯ 'P' ä¸Š -> ç§»åŠ¨è·ç¦» = 0
# æ‰‹æŒ‡ 2 åœ¨å­—æ¯ 'P' ä¸Š -> ç§»åŠ¨è·ç¦» = ä»å­—æ¯ 'P' åˆ°å­—æ¯ 'P' çš„è·ç¦» = 0
# æ‰‹æŒ‡ 1 åœ¨å­—æ¯ 'Y' ä¸Š -> ç§»åŠ¨è·ç¦» = ä»å­—æ¯ 'A' åˆ°å­—æ¯ 'Y' çš„è·ç¦» = 4
# æ€»è·ç¦» = 6
#
#
#  ç¤ºä¾‹ 3ï¼š
#
#  è¾“å…¥ï¼šword = "NEW"
# è¾“å‡ºï¼š3
#
#
#  ç¤ºä¾‹ 4ï¼š
#
#  è¾“å…¥ï¼šword = "YEAR"
# è¾“å‡ºï¼š7
#
#
#
#
#  æç¤ºï¼š
#
#
#  2 <= word.length <= 300
#  æ¯ä¸ª word[i] éƒ½æ˜¯ä¸€ä¸ªå¤§å†™è‹±æ–‡å­—æ¯ã€‚
#
#  Related Topics å­—ç¬¦ä¸² åŠ¨æ€è§„åˆ’
#  ğŸ‘ 57 ğŸ‘ 0

#æœ´ç´ çš„åŠ¨æ€è§„åˆ’
class Solution:
    def minimumDistance(self, word: str) -> int:
        n = len(word)
        dp = [[[float('inf') for _ in range(26)] for _ in range(26)] for _ in range(n)]
        # dp[pos][l][r]
        init=ord(word[0])-65
        for i in range(26):
            dp[0][i][init] = 0  # å³æ‰‹å¤„äºposï¼Œå·¦æ‰‹ä¹±æ”¾
            dp[0][init][i] = 0  # å·¦æ‰‹å¤„äºposï¼Œå³æ‰‹ä¹±æ”¾

        def distance(p, q):
            x1, y1 = divmod(p, 6)
            x2, y2 = divmod(q, 6)
            return abs(x1 - x2) + abs(y1 - y2)

        for pos, ch in enumerate(word[1:], 1):
            cur, prev = ord(ch) - 65, ord(word[pos - 1]) - 65
            d = distance(cur, prev)
            for j in range(26):
                dp[pos][cur][j] = min(dp[pos - 1][prev][j] + d, dp[pos][cur][j])  # å·¦æ‰‹å¤„äºprevï¼Œå·¦æ‰‹è½¬ç§»ï¼Œå³æ‰‹ä½ç½®ä¸å˜
                dp[pos][j][cur] = min(dp[pos - 1][j][prev] + d, dp[pos][j][cur])  # å³æ‰‹å¤„äºprevï¼Œå³æ‰‹è½¬ç§»ï¼Œå·¦æ‰‹ä½ç½®ä¸å˜
                if prev == j:  # prevå¤„äºå·¦æ‰‹ï¼Œä½†å³æ‰‹è½¬ç§»åˆ°curæˆ–è€…prevå¤„äºå³æ‰‹ï¼Œå·¦æ‰‹è½¬ç§»åˆ°ur
                    for k in range(26):
                        nd = distance(cur, k)
                        dp[pos][cur][prev] = min(dp[pos - 1][k][prev] + nd, dp[pos][cur][prev])  # å³æ‰‹å¤„äºprev,å·¦æ‰‹è½¬ç§»åˆ°cur
                        dp[pos][prev][cur] = min(dp[pos - 1][prev][k] + nd, dp[pos][prev][cur])  # å·¦æ‰‹å¤„äºprev,å³æ‰‹è½¬ç§»åˆ°cur
        ans = min(min(dp[-1][k]) for k in range(26))
        return ans
#2ä¼˜åŒ–ç©ºé—´ï¼Œå¯¹ç§°æ¨¡å¼
class Solution:
    def minimumDistance(self, word: str) -> int:
        n = len(word)
        dp=[[float('inf') for _ in range(26)] for _ in range(n)]
        init=ord(word[0])-65
        for i in range(26):
            dp[0][i]=0 #åˆå§‹æƒ…å†µï¼Œä¸è®ºå¦ä¸€åªæ‰‹æ‘†åœ¨å“ªé‡Œï¼Œéƒ½æ˜¯0

        def distance(p, q):
            x1, y1 = divmod(p, 6)
            x2, y2 = divmod(q, 6)
            return abs(x1 - x2) + abs(y1 - y2)

        for pos in range(1,n):
            cur,prev=ord(word[pos])-65,ord(word[pos-1])-65
            d=distance(cur,prev)
            for j in range(26):
                dp[pos][j]=min(dp[pos][j],dp[pos-1][j]+d) #pos-1æ‰‹è½¬ç§»åˆ°posï¼Œå½“å‰æ‰‹å¤„äºpos,å¦ä¸€åªæ‰‹å¤„äºj
                if j==prev:
                    for k in range(26):
                        nd=distance(k,cur)
                        dp[pos][j]=min(dp[pos][j],dp[pos-1][k]+nd) #kæ‰‹è½¬ç§»åˆ°pos,å¦ä¸€åªæ‰‹å˜æˆpos-1å­—æ¯å¤„çš„æ‰‹ï¼Œå³jå¤„
        return min(dp[-1])

Solution().minimumDistance("NEW")
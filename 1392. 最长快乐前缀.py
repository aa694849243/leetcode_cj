# -*- coding: utf-8 -*-
import collections


# ã€Œå¿«ä¹å‰ç¼€ã€æ˜¯åœ¨åŸå­—ç¬¦ä¸²ä¸­æ—¢æ˜¯ éç©º å‰ç¼€ä¹Ÿæ˜¯åç¼€ï¼ˆä¸åŒ…æ‹¬åŸå­—ç¬¦ä¸²è‡ªèº«ï¼‰çš„å­—ç¬¦ä¸²ã€‚
#
#  ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸² sï¼Œè¯·ä½ è¿”å›å®ƒçš„ æœ€é•¿å¿«ä¹å‰ç¼€ã€‚
#
#  å¦‚æœä¸å­˜åœ¨æ»¡è¶³é¢˜æ„çš„å‰ç¼€ï¼Œåˆ™è¿”å›ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ã€‚
#
#
#
#  ç¤ºä¾‹ 1ï¼š
#
#  è¾“å…¥ï¼šs = "level"
# è¾“å‡ºï¼š"l"
# è§£é‡Šï¼šä¸åŒ…æ‹¬ s è‡ªå·±ï¼Œä¸€å…±æœ‰ 4 ä¸ªå‰ç¼€ï¼ˆ"l", "le", "lev", "leve"ï¼‰å’Œ 4 ä¸ªåç¼€ï¼ˆ"l", "el", "vel", "evel
# "ï¼‰ã€‚æœ€é•¿çš„æ—¢æ˜¯å‰ç¼€ä¹Ÿæ˜¯åç¼€çš„å­—ç¬¦ä¸²æ˜¯ "l" ã€‚
#
#
#  ç¤ºä¾‹ 2ï¼š
#
#  è¾“å…¥ï¼šs = "ababab"
# è¾“å‡ºï¼š"abab"
# è§£é‡Šï¼š"abab" æ˜¯æœ€é•¿çš„æ—¢æ˜¯å‰ç¼€ä¹Ÿæ˜¯åç¼€çš„å­—ç¬¦ä¸²ã€‚é¢˜ç›®å…è®¸å‰åç¼€åœ¨åŸå­—ç¬¦ä¸²ä¸­é‡å ã€‚
#
#
#  ç¤ºä¾‹ 3ï¼š
#
#  è¾“å…¥ï¼šs = "leetcodeleet"
# è¾“å‡ºï¼š"leet"
#
#
#  ç¤ºä¾‹ 4ï¼š
#
#  è¾“å…¥ï¼šs = "a"
# è¾“å‡ºï¼š""
#
#
#
#
#  æç¤ºï¼š
#
#
#  1 <= s.length <= 10^5
#  s åªå«æœ‰å°å†™è‹±æ–‡å­—æ¯
#
#  Related Topics å­—ç¬¦ä¸² å­—ç¬¦ä¸²åŒ¹é… å“ˆå¸Œå‡½æ•° æ»šåŠ¨å“ˆå¸Œ
#  ğŸ‘ 59 ğŸ‘ 0

#rabin-karpç®—é•¿åº¦
class Solution:
    def longestPrefix(self, s: str) -> str:
        base, mod = 113, 10 ** 9 + 9
        hash = 0
        m = collections.defaultdict(int)
        for i, ch in enumerate(s):
            hash = (hash * base + ord(ch)) % mod
            m[i + 1] = hash
        n = len(s)
        for i, ch in enumerate(s[:-1]):
            mult = pow(base, n - i - 1, mod)
            x=(hash-m[i+1]*mult)%mod
            if x==m[n-i-1]:
                return s[:n-i-1]
        return ''
Solution().longestPrefix('a')
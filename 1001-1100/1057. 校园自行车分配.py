# -*- coding: utf-8 -*-
from typing import List
import collections
import functools
import itertools
import sortedcontainers
import bisect


# åœ¨ç”± 2D ç½‘æ ¼è¡¨ç¤ºçš„æ ¡å›­é‡Œæœ‰ n ä½å·¥äººï¼ˆworkerï¼‰å’Œ m è¾†è‡ªè¡Œè½¦ï¼ˆbikeï¼‰ï¼Œn <= mã€‚æ‰€æœ‰å·¥äººå’Œè‡ªè¡Œè½¦çš„ä½ç½®éƒ½ç”¨ç½‘æ ¼ä¸Šçš„ 2D åæ ‡è¡¨ç¤ºã€‚
#
#
#  æˆ‘ä»¬éœ€è¦ä¸ºæ¯ä½å·¥äººåˆ†é…ä¸€è¾†è‡ªè¡Œè½¦ã€‚åœ¨æ‰€æœ‰å¯ç”¨çš„è‡ªè¡Œè½¦å’Œå·¥äººä¸­ï¼Œæˆ‘ä»¬é€‰å–å½¼æ­¤ä¹‹é—´æ›¼å“ˆé¡¿è·ç¦»æœ€çŸ­çš„å·¥äººè‡ªè¡Œè½¦å¯¹ (worker, bike) ï¼Œå¹¶å°†å…¶ä¸­çš„è‡ªè¡Œ
# è½¦åˆ†é…çµ¦å·¥äººã€‚å¦‚æœæœ‰å¤šä¸ª (worker, bike) å¯¹ä¹‹é—´çš„æ›¼å“ˆé¡¿è·ç¦»ç›¸åŒï¼Œé‚£ä¹ˆæˆ‘ä»¬é€‰æ‹©å·¥äººç´¢å¼•æœ€å°çš„é‚£å¯¹ã€‚ç±»ä¼¼åœ°ï¼Œå¦‚æœæœ‰å¤šç§ä¸åŒçš„åˆ†é…æ–¹æ³•ï¼Œåˆ™é€‰æ‹©è‡ªè¡Œè½¦ç´¢
# å¼•æœ€å°çš„ä¸€å¯¹ã€‚ä¸æ–­é‡å¤è¿™ä¸€è¿‡ç¨‹ï¼Œç›´åˆ°æ‰€æœ‰å·¥äººéƒ½åˆ†é…åˆ°è‡ªè¡Œè½¦ä¸ºæ­¢ã€‚
#
#  ç»™å®šä¸¤ç‚¹ p1 å’Œ p2 ä¹‹é—´çš„æ›¼å“ˆé¡¿è·ç¦»ä¸º Manhattan(p1, p2) = |p1.x - p2.x| + |p1.y - p2.y|ã€‚
#
#  è¿”å›é•¿åº¦ä¸º n çš„å‘é‡ ansï¼Œå…¶ä¸­ a[i] æ˜¯ç¬¬ i ä½å·¥äººåˆ†é…åˆ°çš„è‡ªè¡Œè½¦çš„ç´¢å¼•ï¼ˆä» 0 å¼€å§‹ï¼‰ã€‚
#
#
#
#  ç¤ºä¾‹ 1ï¼š
#
#
#
#  è¾“å…¥ï¼šworkers = [[0,0],[2,1]], bikes = [[1,2],[3,3]]
# è¾“å‡ºï¼š[1,0]
# è§£é‡Šï¼š
# å·¥äºº 1 åˆ†é…åˆ°è‡ªè¡Œè½¦ 0ï¼Œå› ä¸ºä»–ä»¬æœ€æ¥è¿‘ä¸”ä¸å­˜åœ¨å†²çªï¼Œå·¥äºº 0 åˆ†é…åˆ°è‡ªè¡Œè½¦ 1 ã€‚æ‰€ä»¥è¾“å‡ºæ˜¯ [1,0]ã€‚
#
#
#  ç¤ºä¾‹ 2ï¼š
#
#
#
#  è¾“å…¥ï¼šworkers = [[0,0],[1,1],[2,0]], bikes = [[1,0],[2,2],[2,1]]
# è¾“å‡ºï¼š[0,2,1]
# è§£é‡Šï¼š
# å·¥äºº 0 é¦–å…ˆåˆ†é…åˆ°è‡ªè¡Œè½¦ 0 ã€‚å·¥äºº 1 å’Œå·¥äºº 2 ä¸è‡ªè¡Œè½¦ 2 è·ç¦»ç›¸åŒï¼Œå› æ­¤å·¥äºº 1 åˆ†é…åˆ°è‡ªè¡Œè½¦ 2ï¼Œå·¥äºº 2 å°†åˆ†é…åˆ°è‡ªè¡Œè½¦ 1 ã€‚å› æ­¤è¾“å‡ºä¸º
# [0,2,1]ã€‚
#
#
#
#
#  æç¤ºï¼š
#
#
#  0 <= workers[i][j], bikes[i][j] < 1000
#  æ‰€æœ‰å·¥äººå’Œè‡ªè¡Œè½¦çš„ä½ç½®éƒ½ä¸ç›¸åŒã€‚
#  1 <= workers.length <= bikes.length <= 1000
#
#  Related Topics è´ªå¿ƒ æ•°ç»„ æ’åº ğŸ‘ 82 ğŸ‘ 0


class Solution:
    def assignBikes(self, workers: List[List[int]], bikes: List[List[int]]) -> List[int]:
        from sortedcontainers import SortedDict
        sd = SortedDict()
        for i, (x1, y1) in enumerate(workers):
            for j, (x2, y2) in enumerate(bikes):
                dist = (abs(x1 - x2) + abs(y1 - y2))
                if dist not in sd:
                    sd[dist] = []
                sd[dist].append((i, j))
        cnt = 0
        wn, bn = len(workers), len(bikes)
        wli = [-1] * wn
        bli = [False] * bn
        for dist in sd:
            for i, j in sd[dist]:
                if wli[i] == -1 and not bli[j]:
                    wli[i] = j
                    bli[j] = True
                    cnt += 1
                    if cnt == wn:
                        return wli
        return wli


Solution().assignBikes(workers=[[0, 0], [2, 1]], bikes=[[1, 2], [3, 3]])

#!/usr/bin/env python
# -*- coding: utf-8 -*-
# ç»™å®šä¸€ä¸ª éç©º å­—ç¬¦ä¸²ï¼Œå°†å…¶ç¼–ç ä¸ºå…·æœ‰æœ€çŸ­é•¿åº¦çš„å­—ç¬¦ä¸²ã€‚
#
#  ç¼–ç è§„åˆ™æ˜¯ï¼šk[encoded_string]ï¼Œå…¶ä¸­åœ¨æ–¹æ‹¬å· encoded_string ä¸­çš„å†…å®¹é‡å¤ k æ¬¡ã€‚
#
#  æ³¨ï¼š
#
#
#  k ä¸ºæ­£æ•´æ•°
#  å¦‚æœç¼–ç çš„è¿‡ç¨‹ä¸èƒ½ä½¿å­—ç¬¦ä¸²ç¼©çŸ­ï¼Œåˆ™ä¸è¦å¯¹å…¶è¿›è¡Œç¼–ç ã€‚å¦‚æœæœ‰å¤šç§ç¼–ç æ–¹å¼ï¼Œè¿”å› ä»»æ„ä¸€ç§ å³å¯
#
#
#
#
#  ç¤ºä¾‹ 1ï¼š
#
#
# è¾“å…¥ï¼šs = "aaa"
# è¾“å‡ºï¼š"aaa"
# è§£é‡Šï¼šæ— æ³•å°†å…¶ç¼–ç ä¸ºæ›´çŸ­çš„å­—ç¬¦ä¸²ï¼Œå› æ­¤ä¸è¿›è¡Œç¼–ç ã€‚
#
#
#  ç¤ºä¾‹ 2ï¼š
#
#
# è¾“å…¥ï¼šs = "aaaaa"
# è¾“å‡ºï¼š"5[a]"
# è§£é‡Šï¼š"5[a]" æ¯” "aaaaa" çŸ­ 1 ä¸ªå­—ç¬¦ã€‚
#
#
#  ç¤ºä¾‹ 3ï¼š
#
#
# è¾“å…¥ï¼šs = "aaaaaaaaaa"
# è¾“å‡ºï¼š"10[a]"
# è§£é‡Šï¼š"a9[a]" æˆ– "9[a]a" éƒ½æ˜¯åˆæ³•çš„ç¼–ç ï¼Œå’Œ "10[a]" ä¸€æ ·é•¿åº¦éƒ½ä¸º 5ã€‚
#
#
#  ç¤ºä¾‹ 4ï¼š
#
#
# è¾“å…¥ï¼šs = "aabcaabcd"
# è¾“å‡ºï¼š"2[aabc]d"
# è§£é‡Šï¼š"aabc" å‡ºç°ä¸¤æ¬¡ï¼Œå› æ­¤ä¸€ç§ç­”æ¡ˆå¯ä»¥æ˜¯ "2[aabc]d"ã€‚
#
#
#  ç¤ºä¾‹ 5ï¼š
#
#
# è¾“å…¥ï¼šs = "abbbabbbcabbbabbbc"
# è¾“å‡ºï¼š"2[2[abbb]c]"
# è§£é‡Šï¼š"abbbabbbc" å‡ºç°ä¸¤æ¬¡ï¼Œä½†æ˜¯ "abbbabbbc" å¯ä»¥ç¼–ç ä¸º "2[abbb]c"ï¼Œå› æ­¤ä¸€ç§ç­”æ¡ˆå¯ä»¥æ˜¯ "2[2[abbb]c]"ã€‚
#
#
#
#
#  æç¤ºï¼š
#
#
#  1 <= s.length <= 150
#  s ç”±å°å†™è‹±æ–‡å­—æ¯ç»„æˆ
#
#  Related Topics å­—ç¬¦ä¸² åŠ¨æ€è§„åˆ’
#  ğŸ‘ 79 ğŸ‘ 0

# å­—ç¬¦ä¸²ç¼–ç  ç¼©çŸ­ç¼–ç 
class Solution:
    def encode(self, s: str) -> str:
        n = len(s)
        dp = [[''] * n for _ in range(n)]
        for i in range(n - 1, -1, -1):
            for j in range(i, n):
                dp[i][j] = ss = s[i:j + 1]
                index = (ss + ss).find(ss, 1)
                dp[i][j] = min(dp[i][j], str(len(ss) // index) + '[' + dp[i][i + index - 1] + ']', key=len)
                for k in range(i + 1, j):
                    dp[i][j] = min(dp[i][j], dp[i][k] + dp[k + 1][j], key=len)
        return dp[0][-1]


Solution().encode("aabcaabcd")
